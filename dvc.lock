schema: '2.0'
stages:
  prepare:
    cmd: python -m scripts.prepare
    deps:
    - path: data/train.csv
      md5: d0d12f53a232828404431f2416df09fe
      size: 33430132
    - path: scripts/prepare.py
      md5: 20524be787ecc0bd3158a7a4cdaf20a7
      size: 477
    params:
      params.yaml:
        basic:
          vocab_size: 30000
          min_freq: 3
    outs:
    - path: outputs/vocab.plk
      md5: 14284264890cd690d7bad61190b39ce0
      size: 966319
  train@mlp:
    cmd: python -m scripts.train mlp
    deps:
    - path: data/train.csv
      md5: d0d12f53a232828404431f2416df09fe
      size: 33430132
    - path: outputs/config.json
      md5: cdb8221e0e5eb1a11d5f25ff535fcc38
      size: 85
    - path: outputs/vocab.plk
      md5: 14284264890cd690d7bad61190b39ce0
      size: 966319
    - path: scripts/train.py
      md5: 3bac3a1b6d70dccb466123baa8aeb9e8
      size: 3405
    params:
      params.yaml:
        mlp:
          embed_dim: 50
          use_bag: true
          hidden_size: 512
          dropout: 0.1
        train:
          batch_size: 64
          shuffle: true
          epochs: 3
          kfold: 5
          optimizer:
            lr: 0.0001
            step_lr: 2.0
            gamma: 0.5
            clip: 1.0
    outs:
    - path: outputs/mlp_checkpoint.pth
      md5: a6f458b7f854203a0eb1e9ea89cc56f1
      size: 7162613
    - path: outputs/mlp_plots.csv
      md5: 27630dc781fbe716a00735cf9415abfc
      size: 814
    - path: outputs/mlp_results.json
      md5: fb77733a53d04b7d07e5b3058b6a884b
      size: 125
  train@lstm:
    cmd: python -m scripts.train lstm
    deps:
    - path: data/train.csv
      md5: d0d12f53a232828404431f2416df09fe
      size: 33430132
    - path: outputs/config.json
      md5: cdb8221e0e5eb1a11d5f25ff535fcc38
      size: 85
    - path: outputs/vocab.plk
      md5: 14284264890cd690d7bad61190b39ce0
      size: 966319
    - path: scripts/train.py
      md5: 73f284cb843c42df201b19c244aedeac
      size: 4126
    params:
      params.yaml:
        lstm:
          embed_dim: 128
          use_bag: false
          use_eos: true
          attention_method: concat
          hidden_size: 512
          n_layers: 2
          dropout: 0.33
          max_len: 512
        train:
          batch_size: 32
          shuffle: true
          epochs: 3
          kfold: 5
          optimizer:
            lr: 0.01
            step_lr: 1.0
            gamma: 0.5
            clip: 1.0
    outs:
    - path: outputs/lstm_checkpoint.pth
      md5: 2cf93b349298705593b74beac48c83a7
      size: 59488551
    - path: outputs/lstm_plots.csv
      md5: f317b303aedec8c7f7d21c19f86653c8
      size: 768
    - path: outputs/lstm_results.json
      md5: 450206d0e3026f6381f91cfdaf308e8e
      size: 126
  inference@mlp:
    cmd: python -m scripts.inference mlp
    deps:
    - path: data/test.csv
      md5: 8ba62e41af40f5b5f9e9ed83e5ee3f2a
      size: 33708755
    - path: outputs/config.json
      md5: cdb8221e0e5eb1a11d5f25ff535fcc38
      size: 85
    - path: outputs/mlp_checkpoint.pth
      md5: a6f458b7f854203a0eb1e9ea89cc56f1
      size: 7162613
    - path: scripts/inference.py
      md5: 3824553fe72926fced071bd91ad71d90
      size: 1921
    outs:
    - path: outputs/mlp_submission.csv
      md5: 9109f8f1e8d0fbda81bddc9041c2faf4
      size: 229245
  inference@lstm:
    cmd: python -m scripts.inference lstm
    deps:
    - path: data/test.csv
      md5: 8ba62e41af40f5b5f9e9ed83e5ee3f2a
      size: 33708755
    - path: outputs/config.json
      md5: cdb8221e0e5eb1a11d5f25ff535fcc38
      size: 85
    - path: outputs/lstm_checkpoint.pth
      md5: 2cf93b349298705593b74beac48c83a7
      size: 59488551
    - path: scripts/inference.py
      md5: c4e2e05af3b2dbcf45907646017b8915
      size: 2338
    outs:
    - path: outputs/lstm_submission.csv
      md5: bc70c92f06a91b45b0c84e5b826e7861
      size: 258587
  train@cnn:
    cmd: python -m scripts.train cnn
    deps:
    - path: data/train.csv
      md5: d0d12f53a232828404431f2416df09fe
      size: 33430132
    - path: outputs/config.json
      md5: cdb8221e0e5eb1a11d5f25ff535fcc38
      size: 85
    - path: outputs/vocab.plk
      md5: 14284264890cd690d7bad61190b39ce0
      size: 966319
    - path: scripts/train.py
      md5: e37da7fb95e2b71508e55480397905ad
      size: 3528
    params:
      params.yaml:
        cnn:
          embed_dim: 128
          use_bag: false
          hidden_size: 512
          kernel_size: 3
          n_layers: 4
          dropout: 0.33
          max_len: 512
        train:
          batch_size: 64
          shuffle: true
          epochs: 3
          kfold: 5
          optimizer:
            lr: 0.0001
            step_lr: 2.0
            gamma: 0.5
            clip: 1.0
    outs:
    - path: outputs/cnn_checkpoint.pth
      md5: 3f1690058c3c432329453ef733de978b
      size: 25602311
    - path: outputs/cnn_plots.csv
      md5: 1aade12a295869858f816f8e4f919747
      size: 819
    - path: outputs/cnn_results.json
      md5: bd866328adddd96f785d21b37dc97e5d
      size: 127
  inference@cnn:
    cmd: python -m scripts.inference cnn
    deps:
    - path: data/test.csv
      md5: 8ba62e41af40f5b5f9e9ed83e5ee3f2a
      size: 33708755
    - path: outputs/cnn_checkpoint.pth
      md5: 3f1690058c3c432329453ef733de978b
      size: 25602311
    - path: outputs/config.json
      md5: cdb8221e0e5eb1a11d5f25ff535fcc38
      size: 85
    - path: scripts/inference.py
      md5: 3824553fe72926fced071bd91ad71d90
      size: 1980
    outs:
    - path: outputs/cnn_submission.csv
      md5: 5ec4bc3440cd7a2887bba1a08e29fcd8
      size: 258587
